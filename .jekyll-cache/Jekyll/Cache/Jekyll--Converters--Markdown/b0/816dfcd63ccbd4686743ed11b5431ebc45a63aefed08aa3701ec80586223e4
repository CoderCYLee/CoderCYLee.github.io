I"A<ul id="markdown-toc">
  <li><a href="#配置" id="markdown-toc-配置">配置</a>    <ul>
      <li><a href="#注意" id="markdown-toc-注意">注意</a></li>
    </ul>
  </li>
  <li><a href="#验证" id="markdown-toc-验证">验证</a></li>
</ul>
<hr />

<h1 id="配置">配置</h1>

<p>这里拿<code class="language-plaintext highlighter-rouge">GitHub</code>和<code class="language-plaintext highlighter-rouge">GitLab</code>来举例</p>

<p>首先生成两种不同的<strong>SSH Key</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.ssh
├── config
├── id_rsa          <span class="c"># GitHub</span>
├── id_rsa.pub      <span class="c"># GitHub</span>
├── id_rsa_com      <span class="c"># GitLab</span>
├── id_rsa_com.pub  <span class="c"># GitLab</span>
└── known_hosts
</code></pre></div></div>

<p>然后需要一个<code class="language-plaintext highlighter-rouge">config</code>文件来进行配置</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># config文件内容

Host github.com
    HostName github.com
    PreferredAuthentications publickey
    IdentityFile ~/.ssh/id_rsa

Host gitlab     # 别名，以后连接远程服务器就可以用命令  ssh gitlab
    HostName 192.168.19.224   # 主机名
    Port     22               # 端口
    User     git			  # 用户名
    PreferredAuthentications publickey   
    IdentityFile ~/.ssh/id_rsa_com    # 密钥文件的路径
</code></pre></div></div>

<p>其中<code class="language-plaintext highlighter-rouge">HostName</code>和<code class="language-plaintext highlighter-rouge">Host</code>可以不一致，使用时是用的<code class="language-plaintext highlighter-rouge">Host</code>，个人会写成一致的。</p>

<h2 id="注意">注意</h2>

<p>这里纠正一下，本来我是写成一样的，但是现在这个<code class="language-plaintext highlighter-rouge">ssh</code>我有两个用途，一个是<code class="language-plaintext highlighter-rouge">git ssh</code>，一个是<code class="language-plaintext highlighter-rouge">ssh</code>远程登录，如果写成一样的会导致远程登录的时候也会访问这个<code class="language-plaintext highlighter-rouge">SSH key</code>，如果服务器没有这个<code class="language-plaintext highlighter-rouge">key</code>的话，就会如下：</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@192.168.19.224: Permission denied <span class="o">(</span>publickey,gssapi-keyex,gssapi-with-mic,password<span class="o">)</span><span class="nb">.</span>
</code></pre></div></div>

<p>这个时候该怎么解决呢，有两种方法，</p>

<p>1.<code class="language-plaintext highlighter-rouge">HostName</code>和<code class="language-plaintext highlighter-rouge">Host</code>写成不同的，不过相应的，比如<code class="language-plaintext highlighter-rouge">clone</code>的时候地址也要改变如</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 原来是 git clone git@192.168.19.224:root/test.git</span>
git clone git@gitlab:root/test.git
</code></pre></div></div>

<p>2.在服务器上增加这个<code class="language-plaintext highlighter-rouge">key</code></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~/.ssh/authorized_keys  <span class="c">#在服务器上这个文件里增加你的SSH key</span>
</code></pre></div></div>

<h1 id="验证">验证</h1>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh <span class="nt">-T</span> git@github.com   <span class="c"># ssh -T 用户名@配置文件中的Host</span>
</code></pre></div></div>

:ET